# PITCH DECK MASONRY LAYOUT - COMPLETE SPECIFICATION

## OVERVIEW
Transform the pitch deck from linear slides to a flexible masonry/bento-box grid layout with professional editing capabilities. Keep countdown timer and logo at top. Main content area becomes a responsive grid where investors see a visually impressive, magazine-style layout.

---

## DESIGN REQUIREMENTS

### Visual Style
- Glass morphism design (existing style)
- Dark background (#0A0A0A)
- Orange accent (#cb6b1e)
- Cream text (#f6e1bd)
- Frosted glass cards with backdrop blur
- Rounded corners (2xl = 16px radius)
- Subtle shadows for depth

### Layout Modes
- **Masonry** (NEW - default): Flexible grid layout
- **Vertical** (existing): Traditional scroll
- **Carousel** (existing): Slideshow mode

---

## MOBILE STRATEGY: SMART ADAPTIVE

### Desktop (1024px+)
- 4-column CSS grid
- Auto-flow: dense (fills gaps intelligently)
- Row height: 200px
- Gap: 16px

### Tablet (768px - 1023px)
- 3-column CSS grid
- Same row height and gap
- Slightly compressed but maintains grid personality

### Mobile (<768px)
- **Text boxes**: Always full width (1 column) for readability
- **Small items** (size='small'): Can share row (2 columns) if adjacent to another small item
- **Medium/Large/Wide/Full**: Always full width (videos and PDFs need space)
- Row height: auto (flexible based on content)
- Gap: 12px

**Breakpoint Logic:**
```
Desktop:  grid-cols-4
Tablet:   grid-cols-3  
Mobile:   grid-cols-1 with smart exceptions for small items
```

---

## DATA MODEL UPDATES

### File: `lib/pitchDeck.ts`

Add new types:
```typescript
export type SlideSize = 'small' | 'medium' | 'large' | 'wide' | 'full';
```

Update `PitchDeckSlide` type to include:
```typescript
export type PitchDeckSlide = {
  // ... existing fields ...
  
  // NEW FIELDS:
  size?: SlideSize;  // Controls grid space
  
  // For text formatting (stored as inline HTML/classes):
  textAlign?: 'left' | 'center' | 'right';
  textColor?: string;  // Hex color
  textSize?: 'small' | 'normal' | 'large' | 'xl';
};
```

Update `PitchDeckContent` type:
```typescript
displayMode: 'vertical' | 'carousel' | 'masonry';  // Add 'masonry'
```

Update `DEFAULT_PITCH_DECK`:
```typescript
displayMode: "masonry",  // Change default
slides: [
  {
    id: "slide-1",
    type: "text",
    order: 0,
    textContent: "# Welcome to Baseline\n\nBuilding the performance data layer for baseball and softball.",
    textPosition: "full",
    size: "medium",  // Add default size
  },
]
```

### Size Mappings (CSS Grid Spans)
```
small:  col-span-1 row-span-1    (1x1 grid square)
medium: col-span-2 row-span-2    (2x2 grid squares)
large:  col-span-2 row-span-3    (2x3 - taller)
wide:   col-span-3 row-span-2    (3x2 - wider)
full:   col-span-full row-span-2 (full width)
```

---

## NEW COMPONENT: MasonryPitchDeck

### File: `components/MasonryPitchDeck.tsx`

**Purpose:** Render slides in a responsive masonry grid layout with editing capabilities.

### Props
```typescript
type MasonryPitchDeckProps = {
  slides: PitchDeckSlide[];
  editMode?: boolean;
  onUpdateSlide?: (slideId: string, updates: Partial<PitchDeckSlide>) => void;
  onDeleteSlide?: (slideId: string) => void;
  onMoveSlide?: (slideId: string, direction: "up" | "down") => void;
};
```

### Structure
```tsx
<div className="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 auto-rows-[200px] gap-4 p-4">
  {slides.map(slide => (
    slide.type === 'text' ? <TextBox /> : <ContentBox />
  ))}
</div>
```

### ContentBox Component (PDF/Video)
**Features:**
- Dynamic size classes based on `slide.size`
- Glass morphism styling: `bg-white/5 backdrop-blur-xl border-2 border-white/20`
- Rounded corners: `rounded-2xl`
- Hover effect: `hover:border-[#cb6b1e]/50 transition-all duration-300`
- Embed iframes/videos with proper aspect ratio
- Videos: `object-cover` to fill container cleanly

**Edit Controls (visible on hover in edit mode):**
- Top-right: `[â†‘] [â†“] [Ã—]` buttons
- Bottom-left: Size dropdown

**Video Embedding:**
```tsx
<video
  src={slide.videoUrl}
  controls
  autoPlay={slide.videoAutoplay}
  loop
  muted
  className="w-full h-full object-cover"
/>
```

**PDF Embedding:**
```tsx
<iframe
  src={slide.pdfUrl}
  className="w-full h-full"
  title={slide.pdfFileName || "PDF Slide"}
/>
```

### TextBox Component
**Features:**
- Responsive width: full on mobile, flexible on desktop
- Border style: `border-2 border-dashed border-[#cb6b1e]/50` in edit mode
- Background: `bg-gradient-to-br from-white/5 to-white/0 backdrop-blur-xl`
- Padding: `p-6` for breathing room

**Edit Mode:**
- Textarea with toolbar above it
- Auto-resize textarea to fit content
- Apply formatting classes based on text controls

**View Mode:**
- Render formatted HTML from markdown + inline styles
- Use `dangerouslySetInnerHTML` with formatted text

---

## TEXT EDITING: HYBRID APPROACH

### Toolbar Buttons (Visual Controls)

**Location:** Above textarea in edit mode

**Buttons:**
1. **Bold** - Wraps selection in `**text**`
2. **Italic** - Wraps selection in `*text*`
3. **Text Size** - Dropdown: Small / Normal / Large / XL
4. **Text Color** - Color picker with:
   - Quick access brand colors: #cb6b1e (orange), #f6e1bd (cream), #ffffff (white)
   - Full color picker below
5. **Align** - Left / Center / Right buttons
6. **Clear Formatting** - Remove all inline styles

**Toolbar HTML:**
```tsx
<div className="flex items-center gap-2 mb-2 p-2 bg-white/5 rounded-lg border border-white/10">
  <button onClick={insertBold} className="p-2 hover:bg-white/10 rounded">
    <strong>B</strong>
  </button>
  <button onClick={insertItalic} className="p-2 hover:bg-white/10 rounded">
    <em>I</em>
  </button>
  
  <select onChange={changeTextSize} className="px-2 py-1 bg-white/10 rounded text-sm">
    <option value="small">Small</option>
    <option value="normal">Normal</option>
    <option value="large">Large</option>
    <option value="xl">XL</option>
  </select>
  
  <div className="relative">
    <button onClick={toggleColorPicker} className="p-2 hover:bg-white/10 rounded">
      ðŸŽ¨
    </button>
    {showColorPicker && (
      <div className="absolute top-full mt-2 p-3 bg-[#1a1a1a] border border-white/20 rounded-lg shadow-xl z-50">
        <p className="text-xs text-[#a3a3a3] mb-2">Brand Colors</p>
        <div className="flex gap-2 mb-3">
          <button className="w-8 h-8 rounded-full bg-[#cb6b1e]" onClick={() => setColor('#cb6b1e')} />
          <button className="w-8 h-8 rounded-full bg-[#f6e1bd]" onClick={() => setColor('#f6e1bd')} />
          <button className="w-8 h-8 rounded-full bg-white" onClick={() => setColor('#ffffff')} />
        </div>
        <p className="text-xs text-[#a3a3a3] mb-2">Custom Color</p>
        <input type="color" onChange={(e) => setColor(e.target.value)} className="w-full h-8" />
      </div>
    )}
  </div>
  
  <div className="flex gap-1">
    <button onClick={() => setAlign('left')} className="p-2 hover:bg-white/10 rounded text-xs">â‰¡</button>
    <button onClick={() => setAlign('center')} className="p-2 hover:bg-white/10 rounded text-xs">â‰¡</button>
    <button onClick={() => setAlign('right')} className="p-2 hover:bg-white/10 rounded text-xs">â‰¡</button>
  </div>
  
  <button onClick={clearFormatting} className="ml-auto p-2 hover:bg-white/10 rounded text-xs text-[#a3a3a3]">
    Clear
  </button>
</div>
```

### Markdown Support (Power Users)

Still support standard markdown:
- `# Header` â†’ `<h1>`
- `## Subheader` â†’ `<h2>`
- `**bold**` â†’ `<strong>`
- `*italic*` â†’ `<em>`
- `- bullet` â†’ `<li>`
- `1. numbered` â†’ `<ol><li>`

### Text Formatting Storage

Store formatting as inline HTML in `textContent`:
```html
<div class="text-center">
  <span class="text-xl text-[#cb6b1e]">Important Headline</span>
</div>

Regular markdown text continues below...
```

### Text Size CSS Classes
```css
.text-sm    â†’ Small (14px)
.text-base  â†’ Normal (16px)
.text-lg    â†’ Large (18px)
.text-xl    â†’ XL (20px)
.text-2xl   â†’ Used for headers (24px)
```

---

## PITCH DECK PAGE UPDATES

### File: `app/pitch-deck/page.tsx`

### Display Mode Toggle (Update existing section)
```tsx
<div className="flex gap-2 mb-6">
  <button
    onClick={() => setDisplayMode("vertical")}
    className={mode === "vertical" ? "bg-[#cb6b1e] text-white" : "text-[#a3a3a3]"}
  >
    Scroll View
  </button>
  <button
    onClick={() => setDisplayMode("carousel")}
    className={mode === "carousel" ? "bg-[#cb6b1e] text-white" : "text-[#a3a3a3]"}
  >
    Slideshow
  </button>
  <button
    onClick={() => setDisplayMode("masonry")}
    className={mode === "masonry" ? "bg-[#cb6b1e] text-white" : "text-[#a3a3a3]"}
  >
    Bento Grid
  </button>
</div>
```

### Conditional Rendering
```tsx
{displayMode === 'masonry' && (
  <MasonryPitchDeck
    slides={displaySlides}
    editMode={editMode && !previewMode}
    onUpdateSlide={handleUpdateSlide}
    onDeleteSlide={handleDeleteSlide}
    onMoveSlide={handleMoveSlide}
  />
)}

{displayMode === 'vertical' && (
  /* existing vertical layout */
)}

{displayMode === 'carousel' && (
  /* existing carousel layout */
)}
```

### Edit Mode: Add Slide Controls

Update "Add Content" section:
```tsx
<div className="space-y-4">
  <h3>Add Content</h3>
  
  <div className="flex gap-2">
    <button onClick={() => handleAddSlide("text")}>+ Text Box</button>
    <button onClick={() => handleAddSlide("pdf")}>+ PDF Slide</button>
    <button onClick={() => handleAddSlide("video")}>+ Video</button>
  </div>
  
  {/* NEW: Size selector for next slide */}
  <div>
    <label>Default Size:</label>
    <select value={newSlideSize} onChange={(e) => setNewSlideSize(e.target.value)}>
      <option value="small">Small (1x1)</option>
      <option value="medium">Medium (2x2)</option>
      <option value="large">Large (2x3)</option>
      <option value="wide">Wide (3x2)</option>
      <option value="full">Full Width</option>
    </select>
  </div>
</div>
```

### Update handleAddSlide Function
```typescript
const handleAddSlide = (type: "pdf" | "text" | "video") => {
  if (!formState) return;

  const newSlide: PitchDeckSlide = {
    id: generateSlideId(),
    type,
    order: formState.slides.length,
    size: newSlideSize || "medium",  // Use selected size
    textContent: type === "text" ? "# New Slide\n\nAdd your content here..." : undefined,
    textPosition: type === "text" ? "full" : undefined,
    videoAutoplay: type === "video" ? true : undefined,
  };

  setFormState({
    ...formState,
    slides: [...formState.slides, newSlide],
  });
};
```

---

## STYLING DETAILS

### Video Embed Polish
```tsx
<div className="aspect-video bg-white/5 rounded-2xl overflow-hidden shadow-2xl">
  <video
    src={slide.videoUrl}
    controls
    className="w-full h-full object-cover"
    style={{
      boxShadow: 'inset 0 2px 4px rgba(0,0,0,0.3)'  // Makes it "sink in"
    }}
  />
</div>
```

### PDF Embed Polish
```tsx
<div className="w-full h-full bg-white/5 rounded-2xl overflow-hidden border-2 border-white/10">
  <iframe
    src={slide.pdfUrl}
    className="w-full h-full"
    style={{
      border: 'none',
      background: 'transparent'
    }}
  />
</div>
```

### Text Box Hover States
```css
/* View mode */
.text-box:hover {
  border-color: rgba(203, 107, 30, 0.3);
  transform: translateY(-2px);
  transition: all 0.2s ease;
}

/* Edit mode */
.text-box-editable:hover {
  border-color: rgba(203, 107, 30, 0.7);
  box-shadow: 0 0 20px rgba(203, 107, 30, 0.2);
}
```

---

## MOBILE-SPECIFIC CSS

### Smart Adaptive Logic
```tsx
// In MasonryPitchDeck component
const getResponsiveClasses = (slide: PitchDeckSlide, index: number, slides: PitchDeckSlide[]) => {
  const baseSize = slide.size || 'medium';
  
  // Mobile logic
  if (isMobile) {
    // Text always full width
    if (slide.type === 'text') {
      return 'col-span-1';
    }
    
    // Check if this is a small item and next item is also small
    if (baseSize === 'small' && slides[index + 1]?.size === 'small') {
      return 'col-span-1 sm:col-span-1';  // Could go 2-col on larger mobile
    }
    
    // Everything else full width on mobile
    return 'col-span-1';
  }
  
  // Desktop size mappings
  const sizeMap = {
    small: 'col-span-1 row-span-1',
    medium: 'col-span-2 row-span-2',
    large: 'col-span-2 row-span-3',
    wide: 'col-span-3 row-span-2',
    full: 'col-span-full row-span-2',
  };
  
  return sizeMap[baseSize];
};
```

### Responsive Grid Classes
```tsx
<div className="
  grid
  grid-cols-1           /* Mobile: stack everything */
  md:grid-cols-3        /* Tablet: 3 columns */
  lg:grid-cols-4        /* Desktop: 4 columns */
  auto-rows-[200px]     /* Row height on desktop */
  gap-3 md:gap-4        /* Smaller gap on mobile */
  p-3 md:p-4            /* Smaller padding on mobile */
">
```

---

## TESTING CHECKLIST

After implementation, verify:

### Functionality
- [ ] Can switch between masonry/vertical/carousel modes
- [ ] Edit mode: Can add text/PDF/video slides
- [ ] Edit mode: Size dropdown changes slide size
- [ ] Edit mode: Text toolbar formats text correctly
- [ ] Edit mode: Color picker sets text color
- [ ] Edit mode: Can delete and reorder slides
- [ ] Changes save to database correctly
- [ ] Countdown timer still works at top

### Visual
- [ ] Videos are properly embedded and rounded
- [ ] PDFs load and display correctly
- [ ] Text rendering looks clean and professional
- [ ] Grid layout looks balanced on desktop
- [ ] Hover effects work smoothly
- [ ] Glass morphism effects render correctly

### Responsive
- [ ] Desktop: 4-column grid displays properly
- [ ] Tablet: 3-column grid displays properly
- [ ] Mobile: Content stacks appropriately
- [ ] Mobile: Text is readable (not cramped)
- [ ] Mobile: Videos are full-width and impressive
- [ ] All breakpoints transition smoothly

### Edge Cases
- [ ] Empty pitch deck shows appropriate message
- [ ] Single slide displays correctly
- [ ] Very long text content doesn't break layout
- [ ] Large video files load with spinner
- [ ] Missing PDF/video URLs show error state gracefully

---

## NOTES FOR IMPLEMENTATION

### Keep Existing Features
- Authentication (PIN system)
- Admin mode unlock
- Countdown timer
- Logo display
- Save functionality
- Toast notifications
- All existing vertical/carousel code

### Don't Break
- Database connection
- Supabase queries
- API routes
- File upload system
- Session management

### Code Quality
- Use TypeScript types consistently
- Follow existing naming conventions
- Match existing color scheme variables
- Keep components modular and reusable
- Add comments for complex logic
- Handle loading/error states gracefully

---

## END OF SPECIFICATION